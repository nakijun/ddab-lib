<a href='Hidden comment: 
$Rev$
$Date$
'></a>

# Clipboard Viewer Component Usage Example #

The following is an example of how to use the [Clipboard Viewer Component](ClipboardViewerComponent.md).

Drop a _[TPJCBViewer](TPJCBViewer.md)_ component, a _TButton_ and a _TMemo_ on a form. Do not change any of the components' default properties. Add the _Clipbrd_ unit to your uses clause. Using the object inspector, create the following event handlers:

  * an _[OnClipboardChanged](TPJCBViewerOnClipboardChanged.md)_ handler for the _[TPJCBViewer](TPJCBViewer.md)_ component;
  * an _OnClick_ handler for the _TButton_.

Implement the event handlers as follows:

```
procedure TForm1.PJCBViewer1ClipboardChanged(Sender: TObject);
begin
  // Clipboard has changed - emit beep and decide whether to enable button
  // (only if text is on clipboard)
  MessageBeep(0);
  Button1.Enabled := ClipBoard.HasFormat(CF_TEXT);
end;

procedure TForm1.Button1Click(Sender: TObject);
begin
  // We assume this button can only be clicked when there is text on clipboard,
  // so it is safe to display the text
  Memo1.Text := ClipBoard.AsText;
end;
```

Because _[TPJCBViewer](TPJCBViewer.md)_'s _[TriggerOnCreation](TPJCBViewerTriggerOnCreation.md)_ property is `True` by default, an _[OnClipboardChanged](TPJCBViewerOnClipboardChanged.md)_ event is triggered as the program starts. The beep that is generated by the event handler proves this.

The button is enabled only if the clipboard contains text and becomes greyed out when the clipboard doesn't contain text. Clicking the button displays the clipboard text in the memo. Whenever the clipboard's contents change a beep is emitted.

**Links:**

  * Back to [Clipboard Viewer Component](ClipboardViewerComponent.md)